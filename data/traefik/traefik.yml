#Traefik.yml
api:
  dashboard: true

#Define HTTP and HTTPS entrypoints
entryPoints:
  insecure:
    address: ":80"
      forwardedHeaders:
        - trustedIps = ['127.0.0.1./32']
        - insecure = true
  secure:
    address: ":443"
      forwardedHeaders:
        - trustedIps = ['127.0.0.1./32']
        - insecure = true

#Dynamic configuration will come from docker labels
providers:
  docker:
    endpoint: "unix:///var/run/docker.sock"
    network: "traefik_proxy"
    exposedByDefault: false 

http:
  middlewares:
    traefik=forward-auth:
      forwardauth:
        - address = "http://traefik-forward-auth:4181"
        - authResponseHeaders = ["X-Forwarded-User"]
    testHeader:
      headers:
        customResponseHeaders:
          - X-Custom-Response-Header= ["X-Robots-Tag:noindex,nofollow,nosnippet,noarchive,notranslate,noimageindex"}

#Enable acme with http file challenge
certificatesResolvers:
  le:
    acme:
      email: jriv@suavecito.com
      storage: /acme.json
      httpChallenge:
        # used during the challenge
        entryPoint: insecure
